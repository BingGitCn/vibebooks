import{_ as Y,r as A,l as B,i as f,o as L,f as O,c as m,a as s,g as R,t as r,F as q,d as F,j as X,u as D,e as u}from"./index-BdqTX9py.js";import{b as I}from"./books-DFFPmt4j.js";const H={class:"content-layer"},U={class:"book-immersive"},V={class:"immersive-header"},W={class:"header-badge"},G={class:"immersive-title"},j={key:0,class:"immersive-subtitle"},J={class:"immersive-author"},K={class:"immersive-quote"},Q={class:"book-tags"},Z={class:"interaction-hint"},tt={__name:"BookImmersive",setup(st){const x=D(),S=B(),p=A(null),E=parseInt(S.params.id),o=f(()=>I.find(a=>a.id===E)||I[0]),$=f(()=>o.value.title),v=f(()=>({FICTION:"fiction",PHILOSOPHY:"philosophy","SCIENCE FICTION":"scifi",CLASSIC:"classic",MYSTERY:"mystery",ROMANCE:"romance",ECONOMICS:"economics",DYSTOPIAN:"dystopian",WUXIA:"wuxia",ADVENTURE:"adventure"})[o.value.category]||"default");let y=null,h=[],_=0,g=0;class z{constructor(t,e,n){this.w=t,this.h=e,this.theme=n,this.reset()}reset(){this.x=Math.random()*this.w,this.y=Math.random()*this.h,this.size=Math.random()*3+1,this.speedX=(Math.random()-.5)*.5,this.speedY=(Math.random()-.5)*.5,this.opacity=Math.random()*.5+.2;const t={scifi:[100,200,255],philosophy:[200,180,100],fiction:[150,150,180],mystery:[100,100,120],romance:[255,150,180],classic:[180,160,140],dystopian:[80,100,120],wuxia:[200,100,100],economics:[100,150,100],default:[150,150,150]};this.color=t[this.theme]||t.default}update(){this.x+=this.speedX,this.y+=this.speedY;const t=this.x-_,e=this.y-g,n=Math.sqrt(t*t+e*e);if(n<150){const l=(150-n)/150;this.x+=t/n*l*2,this.y+=e/n*l*2}(this.x<0||this.x>this.w)&&(this.speedX*=-1),(this.y<0||this.y>this.h)&&(this.speedY*=-1)}draw(t){if(t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=`rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, ${this.opacity})`,t.fill(),this.size>2){t.beginPath(),t.arc(this.x,this.y,this.size*2,0,Math.PI*2);const e=t.createRadialGradient(this.x,this.y,0,this.x,this.y,this.size*2);e.addColorStop(0,`rgba(${this.color[0]}, ${this.color[1]}, ${this.color[2]}, ${this.opacity*.3})`),e.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=e,t.fill()}}}function N(){const a=p.value;if(!a)return;const t=a.getContext("2d"),e=()=>{a.width=window.innerWidth,a.height=window.innerHeight};e(),window.addEventListener("resize",e),h=Array.from({length:80},()=>new z(a.width,a.height,v.value));const n=c=>{_=c.clientX,g=c.clientY};window.addEventListener("mousemove",n);const l=()=>{const c=t.createLinearGradient(0,0,0,a.height),w={scifi:["#0a0a1a","#1a1a3a"],philosophy:["#1a1a1a","#2a2520"],fiction:["#1a1a2a","#2a2a3a"],mystery:["#0a0a0a","#1a1a1a"],romance:["#2a1a20","#3a2a30"],classic:["#1a1915","#2a2925"],dystopian:["#0a0a10","#1a1a20"],wuxia:["#1a1010","#2a2020"],economics:["#101a10","#202a20"],default:["#1a1a1a","#2a2a2a"]},b=w[v.value]||w.default;c.addColorStop(0,b[0]),c.addColorStop(1,b[1]),t.fillStyle=c,t.fillRect(0,0,a.width,a.height),h.forEach(i=>{i.update(),i.draw(t)}),h.forEach((i,T)=>{h.slice(T+1).forEach(d=>{const k=i.x-d.x,C=i.y-d.y,M=Math.sqrt(k*k+C*C);M<120&&(t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(d.x,d.y),t.strokeStyle=`rgba(${i.color[0]}, ${i.color[1]}, ${i.color[2]}, ${.15*(1-M/120)})`,t.lineWidth=.5,t.stroke())})}),y=requestAnimationFrame(l)};return l(),()=>{window.removeEventListener("resize",e),window.removeEventListener("mousemove",n)}}const P=()=>{x.push("/universe")};return L(()=>{N()}),O(()=>{y&&cancelAnimationFrame(y)}),(a,t)=>(u(),m("div",{class:X(["immersive-container",`theme-${v.value}`])},[s("canvas",{ref_key:"canvas",ref:p,class:"immersive-canvas"},null,512),s("div",H,[s("button",{class:"back-btn",onClick:P},[...t[0]||(t[0]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),s("span",null,"Back to Universe",-1)])]),s("div",U,[s("header",V,[s("div",W,r(o.value.category),1),s("h1",G,r(o.value.title),1),o.value.subtitle?(u(),m("p",j,r(o.value.subtitle),1)):R("",!0),s("p",J,r(o.value.author),1)]),s("blockquote",K,' "'+r(o.value.quote)+'" ',1),s("div",Q,[(u(!0),m(q,null,F(o.value.tags,e=>(u(),m("span",{key:e,class:"tag"},r(e),1))),128))]),s("div",Z,[s("p",null,"移动鼠标探索"+r($.value)+"的宇宙",1),t[1]||(t[1]=s("div",{class:"hint-dots"},[s("span"),s("span"),s("span")],-1))])])])],2))}},it=Y(tt,[["__scopeId","data-v-90945364"]]);export{it as default};
