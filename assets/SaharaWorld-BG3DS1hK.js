import{_ as K,r as f,o as Q,a as Z,c as S,b,k as T,m as k,T as z,d as M,g as _,t as ee}from"./index-DyitcMFg.js";const te={class:"sahara-world"},ae={key:0,class:"intro-text"},le={key:0,class:"chapter-text"},ie=["innerHTML"],ne={key:0,class:"outro-text"},$=500,oe={__name:"SaharaWorld",setup(se){const t=f(null);let e=null,I=null;const x=f(!0),R=f(!1),y=f(!1),P=f(!1),g=f(0),p=f(""),O=f(!1),w=[{name:"起风",duration:15e3,text:"风，从远方吹来",hasButton:!1},{name:"流动",duration:18e3,text:"沙粒开始流动<br>形成大地的形状",hasButton:!1},{name:"安家",duration:15e3,text:"在这片荒凉中<br>我们建起了家",hasButton:!0},{name:"生活",duration:2e4,text:"生命的过程<br>无论是阳春白雪，还是青菜豆腐",hasButton:!1},{name:"远行",duration:18e3,text:"为何流浪<br>远方有我的梦",hasButton:!0},{name:"橄榄树",duration:15e3,text:"不要问我从哪里来<br>不要问我到哪里去",hasButton:!1},{name:"归宿",duration:2e4,text:"",hasButton:!0}],W=f({x:0,y:0});let m=[],C=0,d=0;const E=()=>{m=[];for(let i=0;i<$;i++)m.push({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,size:Math.random()*2+1,speedX:(Math.random()-.5)*.5,speedY:Math.random()*.5+.2,opacity:Math.random()*.5+.3})},L=()=>{t.value&&(t.value.width=window.innerWidth,t.value.height=window.innerHeight)},q=i=>{const n=e.createLinearGradient(0,0,0,t.value.height);n.addColorStop(0,"#f5e6d3"),n.addColorStop(1,"#d4a574"),e.fillStyle=n,e.fillRect(0,0,t.value.width,t.value.height);const h=i*.8,o=Math.floor($*h);for(let l=0;l<o;l++){const a=m[l],s=i*t.value.height*.7,r=(a.y-s)%t.value.height;e.beginPath(),e.arc(a.x,r,a.size,0,Math.PI*2),e.fillStyle=`rgba(139, 90, 43, ${a.opacity})`,e.fill()}if(i>.3){const l=(i-.3)/.7*.15;e.strokeStyle=`rgba(139, 90, 43, ${l})`,e.lineWidth=1;for(let a=0;a<20;a++){const s=a/20*t.value.height;e.beginPath(),e.moveTo(0,s),e.lineTo(t.value.width,s+Math.sin(d/1e3+a)*20),e.stroke()}}},H=i=>{const n=e.createLinearGradient(0,0,0,t.value.height);n.addColorStop(0,"#f5e6d3"),n.addColorStop(1,"#c9a067"),e.fillStyle=n,e.fillRect(0,0,t.value.width,t.value.height);const h=Math.min(i*1.5,1),o=d/2e3;for(let a=0;a<3;a++){const s=a*100,r=.3-a*.08,c=t.value.height*.6+a*80;e.beginPath(),e.moveTo(0,t.value.height);for(let u=0;u<=t.value.width;u+=10){const v=Math.sin((u+s)/300+o)*50,B=c+v*h;e.lineTo(u,B)}e.lineTo(t.value.width,t.value.height),e.closePath(),e.fillStyle=`rgba(180, 130, 70, ${r})`,e.fill()}const l=i*.6;for(let a=0;a<$;a++){const s=m[a],r=(s.x+d/50)%(t.value.width+100)-50,c=s.y+Math.sin(d/1e3+a)*20;e.beginPath(),e.arc(r,c,s.size,0,Math.PI*2),e.fillStyle=`rgba(139, 90, 43, ${s.opacity*l})`,e.fill()}},N=i=>{if(e.fillStyle="#d4a574",e.fillRect(0,0,t.value.width,t.value.height),e.fillStyle="#c9965f",e.fillRect(0,t.value.height*.6,t.value.width,t.value.height*.4),i>.2){const h=Math.min((i-.2)/.3,1),o=t.value.height*.3-i*50,l=e.createRadialGradient(t.value.width*.7,o,0,t.value.width*.7,o,80);l.addColorStop(0,`rgba(255, 200, 100, ${h})`),l.addColorStop(1,"rgba(255, 200, 100, 0)"),e.fillStyle=l,e.beginPath(),e.arc(t.value.width*.7,o,80,0,Math.PI*2),e.fill()}const n=Math.min(i*2,1);if(n>0){const h=t.value.width*.4,o=t.value.height*.55,l=100;e.fillStyle=`rgba(255, 250, 240, ${n})`,e.fillRect(h-l/2,o-l/2,l,l),e.beginPath(),e.moveTo(h-l/2-20,o-l/2),e.lineTo(h,o-l/2-60),e.lineTo(h+l/2+20,o-l/2),e.closePath(),e.fillStyle=`rgba(200, 150, 100, ${n})`,e.fill(),e.fillStyle=`rgba(255, 165, 0, ${n*.8})`,e.fillRect(h-20,o-10,40,40)}for(let h=0;h<100;h++){const o=m[h];e.beginPath(),e.arc(o.x,o.y+t.value.height*.6,o.size*.8,0,Math.PI*2),e.fillStyle=`rgba(139, 90, 43, ${o.opacity*.3})`,e.fill()}},F=i=>{const n=e.createRadialGradient(t.value.width/2,t.value.height/2,0,t.value.width/2,t.value.height/2,t.value.width/2),h=i*.5;n.addColorStop(0,`rgba(255, 200, 150, ${h})`),n.addColorStop(1,"#d4a574"),e.fillStyle=n,e.fillRect(0,0,t.value.width,t.value.height);const o=5;for(let a=0;a<o;a++){const s=Math.min((i-a*.15)*2,1);if(s>0){const r=t.value.width*(.3+a*.15),c=t.value.height*(.4+Math.sin(a)*.2),u=100+Math.sin(d/1500+a)*30,v=e.createRadialGradient(r,c,0,r,c,u);v.addColorStop(0,`rgba(255, 165, 0, ${s*.4})`),v.addColorStop(1,"rgba(255, 165, 0, 0)"),e.fillStyle=v,e.beginPath(),e.arc(r,c,u,0,Math.PI*2),e.fill()}}[{type:"circle",x:.25,y:.35,size:30},{type:"rect",x:.65,y:.45,size:40},{type:"triangle",x:.45,y:.6,size:35}].forEach((a,s)=>{const r=Math.min((i-s*.1)*3,1)*.6;if(r>0){e.fillStyle=`rgba(255, 250, 240, ${r})`;const c=a.x*t.value.width,u=a.y*t.value.height;a.type==="circle"?(e.beginPath(),e.arc(c,u,a.size,0,Math.PI*2),e.fill()):a.type==="rect"?e.fillRect(c-a.size/2,u-a.size/2,a.size,a.size):a.type==="triangle"&&(e.beginPath(),e.moveTo(c,u-a.size),e.lineTo(c+a.size,u+a.size),e.lineTo(c-a.size,u+a.size),e.closePath(),e.fill())}})},X=i=>{e.fillStyle="#d4a574",e.fillRect(0,0,t.value.width,t.value.height);const n=t.value.height*.55;e.fillStyle="#c9965f",e.fillRect(0,n,t.value.width,t.value.height-n);const h=8;for(let l=0;l<h;l++){const a=(i-l*.08)/.3;if(a>0&&a<=1){const s=t.value.width*(.15+l*.1),r=n+50+l*30,c=15+l*3,u=(1-a)*.6;e.beginPath(),e.ellipse(s-15,r,c*.6,c,0,0,Math.PI*2),e.fillStyle=`rgba(139, 90, 43, ${u})`,e.fill(),e.beginPath(),e.ellipse(s+15,r+40,c*.6,c,0,0,Math.PI*2),e.fill()}}const o=Math.min(i*1.5,1)*.3;e.fillStyle=`rgba(212, 165, 116, ${o})`;for(let l=0;l<20;l++){const a=(d/20+l*100)%(t.value.width+200)-100,s=n+Math.random()*200,r=100+Math.random()*100,c=2+Math.random()*3;e.fillRect(a,s,r,c)}e.strokeStyle=`rgba(255, 255, 255, ${i*.5})`,e.lineWidth=2,e.setLineDash([10,10]),e.beginPath(),e.moveTo(t.value.width*.9,n),e.lineTo(t.value.width*.95,n-100),e.stroke(),e.setLineDash([])},A=i=>{const n=e.createLinearGradient(0,0,0,t.value.height);n.addColorStop(0,"#1a3a5c"),n.addColorStop(1,"#2d4a6c"),e.fillStyle=n,e.fillRect(0,0,t.value.width,t.value.height);const h=50;for(let s=0;s<h;s++){const r=Math.random()*t.value.width,c=Math.random()*t.value.height*.6,u=Math.random()*2+1,v=Math.sin(d/500+s)*.3+.7;e.beginPath(),e.arc(r,c,u,0,Math.PI*2),e.fillStyle=`rgba(255, 255, 255, ${v*i})`,e.fill()}const o=i;e.strokeStyle=`rgba(255, 255, 255, ${o*.6})`,e.lineWidth=3,e.setLineDash([8,12]),e.beginPath(),e.moveTo(t.value.width/2-10,t.value.height*.9),e.lineTo(t.value.width/2,t.value.height*.6),e.lineTo(t.value.width/2+10,t.value.height*.9),e.stroke();const l=t.value.height*.5;e.beginPath(),e.ellipse(t.value.width/2-30,l,40,50,0,0,Math.PI*2),e.stroke(),e.beginPath(),e.ellipse(t.value.width/2+30,l,45,55,0,0,Math.PI*2),e.stroke(),e.beginPath(),e.ellipse(t.value.width/2,l-40,35,40,0,0,Math.PI*2),e.stroke(),e.setLineDash([]);const a=15;for(let s=0;s<a;s++){const r=(i-s*.05)/.5;if(r>0&&r<=1){const c=t.value.width*(.3+s*.05)+Math.sin(d/1e3+s)*30,u=t.value.height*(.3+r*.6),v=8,B=d/500+s;e.save(),e.translate(c,u),e.rotate(B),e.beginPath(),e.ellipse(0,0,v,v/2,0,0,Math.PI*2),e.fillStyle=`rgba(100, 150, 100, ${r*.7})`,e.fill(),e.restore()}}},V=i=>{const n=Math.min(i*2,1);e.fillStyle=`rgba(245, 230, 211, ${n})`,e.fillRect(0,0,t.value.width,t.value.height);const h=i;for(let o=0;o<$;o++){const l=m[o],a=l.y*.8+t.value.height*.2,s=l.y+(a-l.y)*h,r=l.opacity*(1-h*.5);e.beginPath(),e.arc(l.x,s,l.size,0,Math.PI*2),e.fillStyle=`rgba(180, 140, 90, ${r})`,e.fill()}if(i>.5){const o=(i-.5)/.5*.4;e.fillStyle=`rgba(212, 165, 116, ${o})`;const l=60;e.fillRect(t.value.width*.4-l/2,t.value.height*.45-l/2,l,l),e.beginPath(),e.arc(t.value.width*.65,t.value.height*.45,40,0,Math.PI*2),e.fill()}if(i>.7){const o=(i-.7)/.3*.3;e.strokeStyle=`rgba(139, 90, 43, ${o})`,e.lineWidth=2,e.beginPath(),e.arc(t.value.width*.5,t.value.height*.7,20,0,Math.PI*2),e.stroke()}if(i>.9){const o=(i-.9)/.1*.2;e.fillStyle=`rgba(255, 255, 255, ${o})`,e.fillRect(0,0,t.value.width,t.value.height)}},D=()=>{if(!e)return;const i=Date.now();d=i;const n=i-C,h=Math.min(n/w[g.value].duration,1);switch(g.value){case 0:q(h);break;case 1:H(h);break;case 2:N(h);break;case 3:F(h);break;case 4:X(h);break;case 5:A(h);break;case 6:V(h);break}h>=1&&(w[g.value].hasButton?P.value||(P.value=!0,O.value=g.value===w.length-1):Y()),I=requestAnimationFrame(D)},Y=()=>{P.value=!1,y.value=!1,g.value<w.length-1?(g.value++,C=Date.now(),p.value=w[g.value].text,setTimeout(()=>{y.value=!0},1e3)):setTimeout(()=>{R.value=!0,y.value=!1},1e3)},U=()=>{O.value?J():Y()},J=()=>{x.value=!0,R.value=!1,P.value=!1,y.value=!1,g.value=0,p.value="",C=Date.now(),setTimeout(()=>{x.value=!1,p.value=w[0].text,setTimeout(()=>{y.value=!0},1e3)},3e3)},G=i=>{W.value={x:i.clientX,y:i.clientY}},j=()=>{setTimeout(()=>{x.value=!1,p.value=w[0].text,C=Date.now(),setTimeout(()=>{y.value=!0},1e3)},3e3)};return Q(()=>{var i;e=(i=t.value)==null?void 0:i.getContext("2d"),L(),E(),window.addEventListener("resize",L),window.addEventListener("mousemove",G),j(),D()}),Z(()=>{window.removeEventListener("resize",L),window.removeEventListener("mousemove",G),I&&cancelAnimationFrame(I)}),(i,n)=>(M(),S("div",te,[b("canvas",{ref_key:"canvas",ref:t},null,512),T(z,{name:"fade"},{default:k(()=>[x.value?(M(),S("div",ae,[...n[0]||(n[0]=[b("p",{class:"quote"},'"每想你一次，天上飘落一粒沙"',-1),b("p",{class:"quote-sub"},"从此形成了撒哈拉",-1)])])):_("",!0)]),_:1}),T(z,{name:"fade"},{default:k(()=>[y.value&&p.value?(M(),S("div",le,[b("p",{innerHTML:p.value},null,8,ie)])):_("",!0)]),_:1}),T(z,{name:"fade"},{default:k(()=>[P.value?(M(),S("button",{key:0,onClick:U,class:"continue-btn"},ee(O.value?"重新开始":"继续 →"),1)):_("",!0)]),_:1}),T(z,{name:"fade"},{default:k(()=>[R.value?(M(),S("div",ne,[...n[1]||(n[1]=[b("p",{class:"quote"},'"不要问我从哪里来"',-1),b("p",{class:"quote-sub"},"我的故乡在远方",-1),b("p",{class:"author"},"— 三毛",-1)])])):_("",!0)]),_:1})]))}},re=K(oe,[["__scopeId","data-v-e9d6fcfa"]]);export{re as default};
